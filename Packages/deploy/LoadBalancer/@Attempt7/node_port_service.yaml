# ---
# # Source: nginx-gateway-fabric/templates/service.yaml
# apiVersion: v1
# kind: Service
# metadata:
#   name: nginx-gateway-node-port
#   namespace: default
#   labels:
#     app.kubernetes.io/name: nginx-gateway
#     app.kubernetes.io/instance: nginx-gateway
#     app.kubernetes.io/version: "1.0.0"
# spec:
#   type: NodePort
#   selector:
#     app.kubernetes.io/name: nginx-gateway-fabric
#     app.kubernetes.io/instance: ngf
#   ports: # Update the following ports to match your Gateway Listener ports
#   - name: http
#     protocol: TCP
#     nodePort: 31099
#     port: 80
#     targetPort: 80
#   # - name: https
#   #   port: 8443
#   #   protocol: TCP
#   #   targetPort: 443

---
apiVersion: v1
kind: Service
metadata:
  name: nginx-gateway-node-port
  namespace: default
  labels:
    app.kubernetes.io/name: nginx-gateway
    app.kubernetes.io/instance: nginx-gateway
    app.kubernetes.io/version: "1.0.0"
    #app.kubernetes.io/name: "nginx-gateway-fabric"
    #app.kubernetes.io/instance: "ngf"
  # annotations:
  #   meta.helm.sh/release-name: "release-test-1"
  #   meta.helm.sh/release-namespace: "default"
spec:
  type: LoadBalancer
  selector:
    #app.kubernetes.io/name: nginx-gateway-fabric
    app.kubernetes.io/instance: ngf
  ports:
  - name: http
    protocol: TCP
    #nodePort: 32010 # this field seems ignored by LoadBalancer services
    port: 80
    targetPort: 80
  externalIPs:
    - bind_to_address
  ## The externalTrafficPolicy of the service. The value Local preserves the client source IP.
  externalTrafficPolicy: Local
  #internalTrafficPolicy: Local